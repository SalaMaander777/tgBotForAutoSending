{% extends "base.html" %}
{% block title %}–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏{% endblock %}
{% block content %}
<div class="page-header">
    <h1 class="page-title">–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏</h1>
    <div class="page-actions">
        <span class="badge">–í—Å–µ–≥–æ: {{ total }}</span>
        <a href="/admin/export/users.csv" class="btn btn-secondary btn-sm">üì• –≠–∫—Å–ø–æ—Ä—Ç CSV</a>
    </div>
</div>

<div class="table-container">
    <table class="data-table">
        <thead>
            <tr>
                <th>Telegram ID</th>
                <th>Username</th>
                <th>–ò–º—è</th>
                <th>–§–∞–º–∏–ª–∏—è</th>
                <th>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏</th>
                <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–ë–æ—Ç</th>
                <th>–î–µ–π—Å—Ç–≤–∏—è</th>
            </tr>
        </thead>
        <tbody>
            {% for user in users %}
            <tr class="{% if user.is_blocked %}row-blocked{% endif %}">
                <td><code>{{ user.telegram_id }}</code></td>
                <td>{% if user.username %}<a href="https://t.me/{{ user.username }}" target="_blank">@{{ user.username }}</a>{% else %}‚Äî{% endif %}</td>
                <td>{{ user.first_name or '‚Äî' }}</td>
                <td>{{ user.last_name or '‚Äî' }}</td>
                <td>{{ user.joined_at.strftime('%d.%m.%Y %H:%M') if user.joined_at else '‚Äî' }}</td>
                <td>
                    {% if user.is_blocked %}
                    <span class="status-badge status-blocked">–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
                    {% else %}
                    <span class="status-badge status-active">–ü–æ–¥–ø–∏—Å–∞–Ω</span>
                    {% endif %}
                </td>
                <td>{% if user.bot_token %}<code title="{{ user.bot_token }}">‚Ä¶{{ user.bot_token[-8:] }}</code>{% else %}‚Äî{% endif %}</td>
                <td>
                    <a href="/admin/users/{{ user.telegram_id }}/message?bot_token={{ user.bot_token }}" class="btn btn-primary btn-xs">–ù–∞–ø–∏—Å–∞—Ç—å</a>
                </td>
            </tr>
            {% else %}
            <tr>
                <td colspan="8" class="empty-state">–ù–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>

{% if total_pages > 1 %}
<div class="pagination">
    {% if page > 1 %}
    <a href="?page={{ page - 1 }}" class="btn btn-secondary btn-sm">‚Üê –ù–∞–∑–∞–¥</a>
    {% endif %}
    <span class="pagination-info">–°—Ç—Ä–∞–Ω–∏—Ü–∞ {{ page }} –∏–∑ {{ total_pages }}</span>
    {% if page < total_pages %}
    <a href="?page={{ page + 1 }}" class="btn btn-secondary btn-sm">–í–ø–µ—Ä—ë–¥ ‚Üí</a>
    {% endif %}
</div>
{% endif %}
{% endblock %}
