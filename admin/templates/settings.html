{% extends "base.html" %}
{% block title %}Настройки{% endblock %}
{% block content %}
<h1 class="page-title">Настройки</h1>

{% if success %}
<div class="alert alert-success">{{ success }}</div>
{% endif %}
{% if error %}
<div class="alert alert-danger">{{ error }}</div>
{% endif %}

<form method="post" class="form-card">
    <div class="form-group">
        <label for="bot_token">Токен бота</label>
        <input type="password" id="bot_token" name="bot_token"
               value="{{ settings.get('bot_token', '') }}"
               placeholder="1234567890:ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghi"
               autocomplete="off">
        <small class="form-hint">Токен от @BotFather. При изменении бот автоматически перезапустится.</small>
    </div>
    <div class="form-group">
        <label for="channel_id">ID канала</label>
        <input type="text" id="channel_id" name="channel_id"
               value="{{ settings.get('channel_id', '') }}"
               placeholder="-1001234567890">
        <small class="form-hint">Отрицательное число — ID вашего Telegram-канала. Бот должен быть администратором канала.</small>
    </div>
    <div class="form-group">
        <label for="welcome_message">Приветственное сообщение</label>
        <textarea id="welcome_message" name="welcome_message" rows="5"
                  placeholder="Текст, который пользователь получит при /start">{{ settings.get('welcome_message', '') }}</textarea>
        <small class="form-hint">Поддерживается HTML-форматирование. Используется при команде /start.</small>
    </div>
    <div class="form-group">
        <label for="channel_link">Ссылка на канал (запасная)</label>
        <input type="url" id="channel_link" name="channel_link"
               value="{{ settings.get('channel_link', '') }}"
               placeholder="https://t.me/your_channel">
        <small class="form-hint">Используется как запасная ссылка, если не удаётся создать персональную ссылку для приглашения.</small>
    </div>
    <button type="submit" class="btn btn-primary">Сохранить настройки</button>
</form>

<h2 class="page-title" style="margin-top:2rem;font-size:1.25rem;">Смена пароля</h2>

{% if pw_success %}
<div class="alert alert-success">Пароль успешно изменён</div>
{% endif %}
{% if pw_error %}
<div class="alert alert-danger">{{ pw_error }}</div>
{% endif %}

<form method="post" action="/admin/settings/password" class="form-card">
    <div class="form-group">
        <label for="current_password">Текущий пароль</label>
        <input type="password" id="current_password" name="current_password"
               placeholder="Введите текущий пароль" autocomplete="current-password">
    </div>
    <div class="form-group">
        <label for="new_password">Новый пароль</label>
        <input type="password" id="new_password" name="new_password"
               placeholder="Минимум 8 символов" autocomplete="new-password">
    </div>
    <div class="form-group">
        <label for="confirm_password">Подтвердите новый пароль</label>
        <input type="password" id="confirm_password" name="confirm_password"
               placeholder="Повторите новый пароль" autocomplete="new-password">
    </div>
    <button type="submit" class="btn btn-primary">Сменить пароль</button>
</form>
{% endblock %}
